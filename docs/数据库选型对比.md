# ğŸ—„ï¸ æ•°æ®åº“é€‰å‹å¯¹æ¯”åˆ†æ

æœ¬æ–‡æ¡£å¯¹æ¯”åˆ†æäº†èŠå¤©åº”ç”¨ä¸­å¸¸ç”¨çš„æ•°æ®åº“æŠ€æœ¯ï¼Œå¸®åŠ©ç†è§£ä¸ºä»€ä¹ˆé€‰æ‹© MongoDB ä»¥åŠå…¶ä»–æ•°æ®åº“çš„ä¼˜ç¼ºç‚¹ã€‚

## ğŸ“‹ ç›®å½•

- [æ•°æ®åº“ç±»å‹æ¦‚è§ˆ](#æ•°æ®åº“ç±»å‹æ¦‚è§ˆ)
- [ä¸»æµæ•°æ®åº“å¯¹æ¯”](#ä¸»æµæ•°æ®åº“å¯¹æ¯”)
- [èŠå¤©åº”ç”¨åœºæ™¯åˆ†æ](#èŠå¤©åº”ç”¨åœºæ™¯åˆ†æ)
- [è¯¦ç»†å¯¹æ¯”](#è¯¦ç»†å¯¹æ¯”)
- [æ··åˆä½¿ç”¨æ–¹æ¡ˆ](#æ··åˆä½¿ç”¨æ–¹æ¡ˆ)
- [æ€»ç»“å»ºè®®](#æ€»ç»“å»ºè®®)

## ğŸ¯ æ•°æ®åº“ç±»å‹æ¦‚è§ˆ

### æ•°æ®åº“åˆ†ç±»

```
æ•°æ®åº“
â”œâ”€â”€ å…³ç³»å‹æ•°æ®åº“ (SQL)
â”‚   â”œâ”€â”€ MySQL
â”‚   â”œâ”€â”€ PostgreSQL
â”‚   â”œâ”€â”€ SQL Server
â”‚   â””â”€â”€ Oracle
â”‚
â”œâ”€â”€ æ–‡æ¡£å‹æ•°æ®åº“ (NoSQL)
â”‚   â”œâ”€â”€ MongoDB â­ (å½“å‰ä½¿ç”¨)
â”‚   â”œâ”€â”€ CouchDB
â”‚   â””â”€â”€ Firebase
â”‚
â”œâ”€â”€ é”®å€¼å­˜å‚¨ (NoSQL)
â”‚   â”œâ”€â”€ Redis
â”‚   â”œâ”€â”€ Memcached
â”‚   â””â”€â”€ DynamoDB
â”‚
â””â”€â”€ å…¶ä»– NoSQL
    â”œâ”€â”€ åˆ—å¼æ•°æ®åº“ (Cassandra, HBase)
    â”œâ”€â”€ å›¾æ•°æ®åº“ (Neo4j)
    â””â”€â”€ æ—¶åºæ•°æ®åº“ (InfluxDB)
```

## ğŸ“Š ä¸»æµæ•°æ®åº“å¯¹æ¯”

### å¿«é€Ÿå¯¹æ¯”è¡¨

| ç‰¹æ€§ | MongoDB | Redis | MySQL | PostgreSQL |
|------|---------|-------|-------|------------|
| **ç±»å‹** | æ–‡æ¡£å‹ NoSQL | é”®å€¼å­˜å‚¨ | å…³ç³»å‹ SQL | å…³ç³»å‹ SQL |
| **æ•°æ®æ ¼å¼** | JSON/BSON | é”®å€¼å¯¹ | è¡¨æ ¼(è¡Œåˆ—) | è¡¨æ ¼(è¡Œåˆ—) |
| **æŸ¥è¯¢è¯­è¨€** | MongoDB Query | å‘½ä»¤ | SQL | SQL |
| **æ€§èƒ½** | â­â­â­â­ | â­â­â­â­â­ | â­â­â­ | â­â­â­ |
| **æ‰©å±•æ€§** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­ | â­â­â­â­ |
| **çµæ´»æ€§** | â­â­â­â­â­ | â­â­â­ | â­â­ | â­â­â­ |
| **æ•°æ®æŒä¹…åŒ–** | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ |
| **äº‹åŠ¡æ”¯æŒ** | â­â­â­â­ | â­â­ | â­â­â­â­â­ | â­â­â­â­â­ |
| **å­¦ä¹ æ›²çº¿** | ç®€å• | ç®€å• | ä¸­ç­‰ | ä¸­ç­‰ |
| **é€‚åˆåœºæ™¯** | å®æ—¶åº”ç”¨ | ç¼“å­˜/ä¼šè¯ | ä¼ ç»Ÿåº”ç”¨ | å¤æ‚æŸ¥è¯¢ |

## ğŸ® èŠå¤©åº”ç”¨åœºæ™¯åˆ†æ

### èŠå¤©åº”ç”¨çš„æ•°æ®ç‰¹ç‚¹

1. **é«˜å¹¶å‘è¯»å†™** ğŸ“ˆ
   - ç”¨æˆ·é¢‘ç¹å‘é€å’Œæ¥æ”¶æ¶ˆæ¯
   - éœ€è¦å¿«é€Ÿçš„è¯»å†™æ€§èƒ½

2. **æ•°æ®ç»“æ„çµæ´»** ğŸ”„
   - ä¸åŒç±»å‹çš„æ¶ˆæ¯(æ–‡æœ¬ã€å›¾ç‰‡ã€æ–‡ä»¶)
   - æ¶ˆæ¯æ ¼å¼å¯èƒ½éšæ—¶æ‰©å±•

3. **å®æ—¶æ€§è¦æ±‚é«˜** âš¡
   - æ¶ˆæ¯éœ€è¦å³æ—¶é€è¾¾
   - åœ¨çº¿çŠ¶æ€å®æ—¶æ›´æ–°

4. **æ•°æ®é‡å¤§** ğŸ’¾
   - æ¶ˆæ¯å†å²æŒç»­å¢é•¿
   - éœ€è¦é«˜æ•ˆçš„å­˜å‚¨å’ŒæŸ¥è¯¢

5. **æŸ¥è¯¢æ¨¡å¼** ğŸ”
   - ä¸»è¦æ˜¯ç®€å•æŸ¥è¯¢(æŒ‰æ—¶é—´ã€ç”¨æˆ·)
   - è¾ƒå°‘å¤æ‚çš„å…³è”æŸ¥è¯¢

## ğŸ“– è¯¦ç»†å¯¹æ¯”

### 1. MongoDB (æ–‡æ¡£å‹æ•°æ®åº“) â­ å½“å‰é€‰æ‹©

#### ä¼˜ç‚¹ âœ…

**1. æ•°æ®ç»“æ„çµæ´»**
```javascript
// å¯ä»¥å­˜å‚¨ä¸åŒç»“æ„çš„æ¶ˆæ¯
{
  type: "text",
  content: "Hello",
  timestamp: "2025-11-25T10:00:00Z"
}

{
  type: "image",
  imageUrl: "https://...",
  thumbnail: "https://...",
  timestamp: "2025-11-25T10:01:00Z"
}
```

**2. JSON åŸç”Ÿæ”¯æŒ**
- ä¸ JavaScript/Node.js å®Œç¾å¥‘åˆ
- æ— éœ€ ORM è½¬æ¢
- å‰åç«¯æ•°æ®æ ¼å¼ç»Ÿä¸€

**3. é«˜æ€§èƒ½è¯»å†™**
- é€‚åˆé«˜å¹¶å‘åœºæ™¯
- å†™å…¥é€Ÿåº¦å¿«
- æ”¯æŒç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢

**4. æ˜“äºæ‰©å±•**
- æ”¯æŒæ°´å¹³æ‰©å±•(åˆ†ç‰‡)
- æ•°æ®é‡å¢é•¿æ—¶æ˜“äºåº”å¯¹

**5. ä¸°å¯Œçš„æŸ¥è¯¢èƒ½åŠ›**
```javascript
// å¤æ‚æŸ¥è¯¢ç¤ºä¾‹
await Message.find({
  timestamp: { $gte: startDate, $lte: endDate },
  username: { $in: ['å¼ ä¸‰', 'æå››'] },
  content: { $regex: /å…³é”®è¯/i }
});
```

#### ç¼ºç‚¹ âŒ

**1. å†…å­˜å ç”¨è¾ƒå¤§**
- éœ€è¦è¾ƒå¤šçš„ RAM
- ç´¢å¼•ä¼šå ç”¨é¢å¤–ç©ºé—´

**2. äº‹åŠ¡æ”¯æŒæœ‰é™**
- è™½ç„¶æ”¯æŒäº‹åŠ¡,ä½†ä¸å¦‚ä¼ ç»Ÿ SQL æ•°æ®åº“å¼ºå¤§
- è·¨æ–‡æ¡£äº‹åŠ¡æ€§èƒ½è¾ƒå·®

**3. æ•°æ®ä¸€è‡´æ€§**
- æœ€ç»ˆä¸€è‡´æ€§æ¨¡å‹
- ä¸é€‚åˆå¼ºä¸€è‡´æ€§è¦æ±‚çš„åœºæ™¯

#### é€‚ç”¨åœºæ™¯ ğŸ¯

- âœ… å®æ—¶èŠå¤©åº”ç”¨
- âœ… å†…å®¹ç®¡ç†ç³»ç»Ÿ
- âœ… æ—¥å¿—å’Œåˆ†æç³»ç»Ÿ
- âœ… ç‰©è”ç½‘æ•°æ®å­˜å‚¨
- âŒ é“¶è¡Œäº¤æ˜“ç³»ç»Ÿ
- âŒ å¤æ‚å…³è”æŸ¥è¯¢

---

### 2. Redis (é”®å€¼å­˜å‚¨)

#### ä¼˜ç‚¹ âœ…

**1. æé«˜çš„æ€§èƒ½**
- å†…å­˜å­˜å‚¨,è¯»å†™é€Ÿåº¦æå¿«
- æ”¯æŒæ¯ç§’æ•°åä¸‡æ¬¡æ“ä½œ

**2. ä¸°å¯Œçš„æ•°æ®ç±»å‹**
```javascript
// String - ç®€å•å€¼
SET user:1001:name "å¼ ä¸‰"

// Hash - ç”¨æˆ·ä¿¡æ¯
HSET user:1001 name "å¼ ä¸‰" status "online"

// List - æ¶ˆæ¯é˜Ÿåˆ—
LPUSH messages:room1 "æ¶ˆæ¯å†…å®¹"

// Set - åœ¨çº¿ç”¨æˆ·
SADD online:users "user1" "user2"

// Sorted Set - æ’è¡Œæ¦œ
ZADD leaderboard 100 "user1"
```

**3. å‘å¸ƒ/è®¢é˜…åŠŸèƒ½**
```javascript
// éå¸¸é€‚åˆå®æ—¶æ¶ˆæ¯æ¨é€
publisher.publish('chat:room1', 'æ–°æ¶ˆæ¯');
subscriber.subscribe('chat:room1');
```

**4. è¿‡æœŸæ—¶é—´**
```javascript
// è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®
SET session:abc123 "data" EX 3600  // 1å°æ—¶åè¿‡æœŸ
```

#### ç¼ºç‚¹ âŒ

**1. æ•°æ®æŒä¹…åŒ–æœ‰é™**
- ä¸»è¦åœ¨å†…å­˜ä¸­,æ–­ç”µå¯èƒ½ä¸¢å¤±æ•°æ®
- è™½æœ‰æŒä¹…åŒ–æœºåˆ¶,ä½†ä¸å¦‚ç£ç›˜æ•°æ®åº“å¯é 

**2. å†…å­˜æˆæœ¬é«˜**
- æ‰€æœ‰æ•°æ®åœ¨å†…å­˜ä¸­
- å¤§é‡æ•°æ®å­˜å‚¨æˆæœ¬é«˜

**3. æŸ¥è¯¢èƒ½åŠ›æœ‰é™**
- ä¸æ”¯æŒå¤æ‚æŸ¥è¯¢
- æ²¡æœ‰ SQL é‚£æ ·çš„æŸ¥è¯¢è¯­è¨€

**4. æ•°æ®ç»“æ„ç®€å•**
- ä¸é€‚åˆå­˜å‚¨å¤æ‚çš„åµŒå¥—æ•°æ®

#### é€‚ç”¨åœºæ™¯ ğŸ¯

- âœ… ç¼“å­˜å±‚
- âœ… ä¼šè¯å­˜å‚¨
- âœ… å®æ—¶æ’è¡Œæ¦œ
- âœ… æ¶ˆæ¯é˜Ÿåˆ—
- âœ… åœ¨çº¿ç”¨æˆ·åˆ—è¡¨
- âŒ ä¸»æ•°æ®å­˜å‚¨
- âŒ å¤æ‚æ•°æ®å…³ç³»

#### åœ¨èŠå¤©åº”ç”¨ä¸­çš„ä½¿ç”¨

```javascript
// ç¤ºä¾‹ï¼šRedis ä½œä¸ºè¾…åŠ©å­˜å‚¨

// 1. å­˜å‚¨åœ¨çº¿ç”¨æˆ·
await redis.sadd('online:users', userId);

// 2. å­˜å‚¨æœªè¯»æ¶ˆæ¯è®¡æ•°
await redis.hincrby('unread:count', userId, 1);

// 3. ç¼“å­˜ç”¨æˆ·ä¿¡æ¯
await redis.setex(`user:${userId}`, 3600, JSON.stringify(userInfo));

// 4. å‘å¸ƒæ¶ˆæ¯é€šçŸ¥
await redis.publish('chat:notifications', JSON.stringify(message));
```

---

### 3. MySQL (å…³ç³»å‹æ•°æ®åº“)

#### ä¼˜ç‚¹ âœ…

**1. æˆç†Ÿç¨³å®š**
- ä½¿ç”¨å¹¿æ³›,ç¤¾åŒºæ”¯æŒå¥½
- ç»è¿‡å¤šå¹´éªŒè¯

**2. å¼ºå¤§çš„äº‹åŠ¡æ”¯æŒ**
```sql
START TRANSACTION;
INSERT INTO messages (user_id, content) VALUES (1, 'Hello');
UPDATE users SET message_count = message_count + 1 WHERE id = 1;
COMMIT;
```

**3. å®Œæ•´çš„ ACID ç‰¹æ€§**
- åŸå­æ€§(Atomicity)
- ä¸€è‡´æ€§(Consistency)
- éš”ç¦»æ€§(Isolation)
- æŒä¹…æ€§(Durability)

**4. å¤æ‚æŸ¥è¯¢èƒ½åŠ›**
```sql
-- å¤šè¡¨å…³è”æŸ¥è¯¢
SELECT u.username, m.content, m.timestamp
FROM messages m
JOIN users u ON m.user_id = u.id
WHERE m.room_id = 1
ORDER BY m.timestamp DESC
LIMIT 100;
```

**5. æ•°æ®å®Œæ•´æ€§**
- å¤–é”®çº¦æŸ
- å”¯ä¸€æ€§çº¦æŸ
- æ•°æ®éªŒè¯

#### ç¼ºç‚¹ âŒ

**1. æ¨¡å¼å›ºå®š**
```sql
-- å¿…é¡»é¢„å®šä¹‰è¡¨ç»“æ„
CREATE TABLE messages (
  id INT PRIMARY KEY,
  user_id INT NOT NULL,
  content TEXT,
  timestamp DATETIME,
  -- æ·»åŠ æ–°å­—æ®µéœ€è¦ ALTER TABLE
);
```

**2. æ‰©å±•æ€§å·®**
- å‚ç›´æ‰©å±•ä¸ºä¸»(å‡çº§ç¡¬ä»¶)
- æ°´å¹³æ‰©å±•(åˆ†åº“åˆ†è¡¨)å¤æ‚

**3. JSON æ”¯æŒæœ‰é™**
- è™½ç„¶æ”¯æŒ JSON ç±»å‹,ä½†ä¸å¦‚ MongoDB åŸç”Ÿ

**4. æ€§èƒ½ç“¶é¢ˆ**
- å¤§é‡å†™å…¥æ—¶æ€§èƒ½ä¸‹é™
- å¤æ‚æŸ¥è¯¢å¯èƒ½å¾ˆæ…¢

#### é€‚ç”¨åœºæ™¯ ğŸ¯

- âœ… ç”µå•†ç³»ç»Ÿ
- âœ… è´¢åŠ¡ç³»ç»Ÿ
- âœ… ERP/CRM ç³»ç»Ÿ
- âœ… éœ€è¦å¤æ‚å…³è”æŸ¥è¯¢
- âŒ é«˜å¹¶å‘å†™å…¥
- âŒ çµæ´»çš„æ•°æ®ç»“æ„

#### èŠå¤©åº”ç”¨ä¸­çš„è¡¨è®¾è®¡

```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
  id INT PRIMARY KEY AUTO_INCREMENT,
  username VARCHAR(50) UNIQUE NOT NULL,
  is_online BOOLEAN DEFAULT FALSE,
  last_active DATETIME,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- æ¶ˆæ¯è¡¨
CREATE TABLE messages (
  id INT PRIMARY KEY AUTO_INCREMENT,
  user_id INT NOT NULL,
  room_id INT,
  content TEXT NOT NULL,
  message_type ENUM('text', 'image', 'file') DEFAULT 'text',
  timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id),
  INDEX idx_timestamp (timestamp),
  INDEX idx_room_user (room_id, user_id)
);

-- ç§èŠæ¶ˆæ¯è¡¨
CREATE TABLE private_messages (
  id INT PRIMARY KEY AUTO_INCREMENT,
  from_user_id INT NOT NULL,
  to_user_id INT NOT NULL,
  content TEXT NOT NULL,
  is_read BOOLEAN DEFAULT FALSE,
  timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (from_user_id) REFERENCES users(id),
  FOREIGN KEY (to_user_id) REFERENCES users(id),
  INDEX idx_conversation (from_user_id, to_user_id, timestamp)
);
```

---

### 4. PostgreSQL (é«˜çº§å…³ç³»å‹æ•°æ®åº“)

#### ä¼˜ç‚¹ âœ…

**1. åŠŸèƒ½æœ€å¼ºå¤§çš„å¼€æºæ•°æ®åº“**
- æ”¯æŒå¤æ‚æ•°æ®ç±»å‹
- å¼ºå¤§çš„æ‰©å±•æ€§

**2. ä¼˜ç§€çš„ JSON æ”¯æŒ**
```sql
-- JSONB ç±»å‹,æ€§èƒ½ä¼˜ç§€
CREATE TABLE messages (
  id SERIAL PRIMARY KEY,
  user_id INT,
  content JSONB,  -- å¯ä»¥å­˜å‚¨ä»»æ„ JSON ç»“æ„
  timestamp TIMESTAMPTZ
);

-- JSON æŸ¥è¯¢
SELECT * FROM messages 
WHERE content->>'type' = 'image';
```

**3. å…¨æ–‡æœç´¢**
```sql
-- å†…ç½®å…¨æ–‡æœç´¢
SELECT * FROM messages 
WHERE to_tsvector('chinese', content) @@ to_tsquery('chinese', 'å…³é”®è¯');
```

**4. é«˜çº§ç‰¹æ€§**
- çª—å£å‡½æ•°
- é€’å½’æŸ¥è¯¢
- æ•°ç»„ç±»å‹
- è‡ªå®šä¹‰ç±»å‹

#### ç¼ºç‚¹ âŒ

**1. å­¦ä¹ æ›²çº¿é™¡å³­**
- åŠŸèƒ½å¤š,å¤æ‚åº¦é«˜
- éœ€è¦æ›´å¤šå­¦ä¹ æ—¶é—´

**2. é…ç½®å¤æ‚**
- æ€§èƒ½ä¼˜åŒ–éœ€è¦ä¸“ä¸šçŸ¥è¯†
- é»˜è®¤é…ç½®å¯èƒ½ä¸å¤Ÿä¼˜åŒ–

**3. èµ„æºå ç”¨**
- å†…å­˜å’Œ CPU å ç”¨è¾ƒé«˜

#### é€‚ç”¨åœºæ™¯ ğŸ¯

- âœ… éœ€è¦å¤æ‚æŸ¥è¯¢çš„åº”ç”¨
- âœ… åœ°ç†ä¿¡æ¯ç³»ç»Ÿ(GIS)
- âœ… æ•°æ®åˆ†æå¹³å°
- âœ… éœ€è¦ JSON å’Œå…³ç³»å‹æ··åˆçš„åœºæ™¯
- âŒ ç®€å•çš„ CRUD åº”ç”¨
- âŒ èµ„æºå—é™çš„ç¯å¢ƒ

---

## ğŸ”€ æ··åˆä½¿ç”¨æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: MongoDB + Redis (æ¨è)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å®¢æˆ·ç«¯è¯·æ±‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Node.js æœåŠ¡å™¨              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Redis   â”‚      â”‚ MongoDB  â”‚   â”‚
â”‚  â”‚  ç¼“å­˜å±‚  â”‚      â”‚ æŒä¹…å±‚   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                  â”‚         â”‚
â”‚       â–¼                  â–¼         â”‚
â”‚  â€¢ åœ¨çº¿ç”¨æˆ·          â€¢ ç”¨æˆ·ä¿¡æ¯   â”‚
â”‚  â€¢ æœªè¯»è®¡æ•°          â€¢ æ¶ˆæ¯å†å²   â”‚
â”‚  â€¢ ä¼šè¯ç¼“å­˜          â€¢ ç§èŠè®°å½•   â”‚
â”‚  â€¢ å®æ—¶æ¨é€          â€¢ æŒä¹…åŒ–æ•°æ® â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä½¿ç”¨åœºæ™¯åˆ†é…**:

| æ•°æ®ç±»å‹ | ä½¿ç”¨æ•°æ®åº“ | åŸå›  |
|---------|-----------|------|
| åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ | Redis | é¢‘ç¹å˜åŒ–,éœ€è¦æå¿«é€Ÿåº¦ |
| æœªè¯»æ¶ˆæ¯è®¡æ•° | Redis | å®æ—¶æ›´æ–°,ä¸´æ—¶æ•°æ® |
| æ¶ˆæ¯å†å² | MongoDB | éœ€è¦æŒä¹…åŒ–,æ”¯æŒå¤æ‚æŸ¥è¯¢ |
| ç”¨æˆ·ä¿¡æ¯ | MongoDB | éœ€è¦æŒä¹…åŒ– |
| ä¼šè¯ç¼“å­˜ | Redis | ä¸´æ—¶æ•°æ®,å¿«é€Ÿè®¿é—® |
| å®æ—¶é€šçŸ¥ | Redis Pub/Sub | å®æ—¶æ¨é€ |

**ä»£ç ç¤ºä¾‹**:

```javascript
// å‘é€æ¶ˆæ¯æµç¨‹
async function sendMessage(userId, content) {
  // 1. ä¿å­˜åˆ° MongoDB (æŒä¹…åŒ–)
  const message = await Message.create({
    userId,
    content,
    timestamp: new Date()
  });
  
  // 2. æ›´æ–° Redis ç¼“å­˜
  await redis.lpush('recent:messages', JSON.stringify(message));
  await redis.ltrim('recent:messages', 0, 99);  // åªä¿ç•™æœ€è¿‘ 100 æ¡
  
  // 3. é€šè¿‡ Redis å‘å¸ƒå®æ—¶é€šçŸ¥
  await redis.publish('chat:new-message', JSON.stringify(message));
  
  return message;
}

// è·å–æ¶ˆæ¯æµç¨‹
async function getMessages(limit = 100) {
  // 1. å…ˆä» Redis ç¼“å­˜è·å–
  const cached = await redis.lrange('recent:messages', 0, limit - 1);
  
  if (cached.length >= limit) {
    return cached.map(JSON.parse);
  }
  
  // 2. ç¼“å­˜æœªå‘½ä¸­,ä» MongoDB è·å–
  const messages = await Message.find()
    .sort({ timestamp: -1 })
    .limit(limit);
  
  // 3. æ›´æ–°ç¼“å­˜
  if (messages.length > 0) {
    await redis.del('recent:messages');
    for (const msg of messages.reverse()) {
      await redis.lpush('recent:messages', JSON.stringify(msg));
    }
  }
  
  return messages;
}
```

### æ–¹æ¡ˆ 2: PostgreSQL + Redis

é€‚åˆéœ€è¦å¤æ‚æŸ¥è¯¢å’Œå¼ºä¸€è‡´æ€§çš„åœºæ™¯:

```javascript
// ä½¿ç”¨ PostgreSQL çš„ JSONB å­˜å‚¨çµæ´»æ•°æ®
CREATE TABLE messages (
  id SERIAL PRIMARY KEY,
  user_id INT,
  content JSONB,
  metadata JSONB,
  timestamp TIMESTAMPTZ DEFAULT NOW()
);

// é…åˆ Redis ç¼“å­˜
```

### æ–¹æ¡ˆ 3: MySQL + Redis

é€‚åˆä¼ ç»Ÿä¼ä¸šåº”ç”¨:

```javascript
// MySQL å­˜å‚¨ç»“æ„åŒ–æ•°æ®
// Redis æä¾›ç¼“å­˜å’Œä¼šè¯ç®¡ç†
```

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”æµ‹è¯•

### å†™å…¥æ€§èƒ½ (æ¯ç§’æ“ä½œæ•°)

| æ•°æ®åº“ | å•æ¡æ’å…¥ | æ‰¹é‡æ’å…¥(1000æ¡) |
|--------|---------|-----------------|
| MongoDB | ~10,000 | ~50,000 |
| Redis | ~100,000 | ~500,000 |
| MySQL | ~5,000 | ~20,000 |
| PostgreSQL | ~6,000 | ~25,000 |

### æŸ¥è¯¢æ€§èƒ½ (æ¯«ç§’)

| æ“ä½œ | MongoDB | Redis | MySQL | PostgreSQL |
|------|---------|-------|-------|------------|
| æŒ‰ ID æŸ¥è¯¢ | 1-2ms | <1ms | 2-5ms | 2-5ms |
| èŒƒå›´æŸ¥è¯¢ | 5-10ms | N/A | 10-20ms | 10-20ms |
| èšåˆæŸ¥è¯¢ | 20-50ms | N/A | 50-100ms | 30-80ms |

*æ³¨: æ€§èƒ½æ•°æ®ä»…ä¾›å‚è€ƒ,å®é™…æ€§èƒ½å–å†³äºç¡¬ä»¶ã€é…ç½®å’Œæ•°æ®é‡*

## ğŸ¯ æ€»ç»“å»ºè®®

### å½“å‰é¡¹ç›®é€‰æ‹©: MongoDB âœ…

**ç†ç”±**:

1. âœ… **å¼€å‘æ•ˆç‡é«˜**: JSON æ ¼å¼ä¸ Node.js å®Œç¾å¥‘åˆ
2. âœ… **æ€§èƒ½ä¼˜ç§€**: æ»¡è¶³èŠå¤©åº”ç”¨çš„é«˜å¹¶å‘éœ€æ±‚
3. âœ… **çµæ´»æ€§å¥½**: æ¶ˆæ¯æ ¼å¼å¯ä»¥éšæ—¶æ‰©å±•
4. âœ… **å­¦ä¹ æ›²çº¿å¹³ç¼“**: æ¯” SQL æ•°æ®åº“æ›´å®¹æ˜“ä¸Šæ‰‹
5. âœ… **æ‰©å±•æ€§å¼º**: æœªæ¥æ•°æ®é‡å¢é•¿æ—¶æ˜“äºåº”å¯¹

### å„æ•°æ®åº“æ¨èåœºæ™¯

#### é€‰æ‹© MongoDB å½“:
- âœ… æ„å»ºå®æ—¶åº”ç”¨(èŠå¤©ã€åä½œå·¥å…·)
- âœ… æ•°æ®ç»“æ„çµæ´»å¤šå˜
- âœ… éœ€è¦å¿«é€Ÿè¿­ä»£å¼€å‘
- âœ… ä½¿ç”¨ Node.js/JavaScript æŠ€æœ¯æ ˆ

#### é€‰æ‹© Redis å½“:
- âœ… éœ€è¦æé«˜æ€§èƒ½çš„ç¼“å­˜
- âœ… å®æ—¶æ’è¡Œæ¦œã€è®¡æ•°å™¨
- âœ… ä¼šè¯ç®¡ç†
- âœ… æ¶ˆæ¯é˜Ÿåˆ—
- âŒ ä¸è¦ä½œä¸ºä¸»æ•°æ®åº“

#### é€‰æ‹© MySQL å½“:
- âœ… æ•°æ®å…³ç³»å¤æ‚,éœ€è¦å¤šè¡¨å…³è”
- âœ… éœ€è¦å¼ºäº‹åŠ¡æ”¯æŒ(å¦‚ç”µå•†è®¢å•)
- âœ… æ•°æ®ç»“æ„ç¨³å®š,ä¸å¸¸å˜åŒ–
- âœ… å›¢é˜Ÿç†Ÿæ‚‰ SQL

#### é€‰æ‹© PostgreSQL å½“:
- âœ… éœ€è¦ SQL å’Œ JSON æ··åˆä½¿ç”¨
- âœ… å¤æ‚çš„æ•°æ®åˆ†æéœ€æ±‚
- âœ… åœ°ç†ä¿¡æ¯ç³»ç»Ÿ
- âœ… éœ€è¦é«˜çº§æ•°æ®åº“ç‰¹æ€§

### å‡çº§è·¯å¾„å»ºè®®

```
é˜¶æ®µ 1: å¼€å‘é˜¶æ®µ (å½“å‰)
â””â”€â”€ MongoDB (ç®€å•å¿«é€Ÿ)

é˜¶æ®µ 2: ä¼˜åŒ–é˜¶æ®µ
â””â”€â”€ MongoDB + Redis
    â”œâ”€â”€ MongoDB: æŒä¹…åŒ–å­˜å‚¨
    â””â”€â”€ Redis: ç¼“å­˜å’Œå®æ—¶åŠŸèƒ½

é˜¶æ®µ 3: å¤§è§„æ¨¡é˜¶æ®µ
â””â”€â”€ MongoDB + Redis + æ¶ˆæ¯é˜Ÿåˆ—
    â”œâ”€â”€ MongoDB: åˆ†ç‰‡é›†ç¾¤
    â”œâ”€â”€ Redis: é›†ç¾¤æ¨¡å¼
    â””â”€â”€ RabbitMQ/Kafka: æ¶ˆæ¯é˜Ÿåˆ—
```

## ğŸ“š å‚è€ƒèµ„æº

- [MongoDB vs MySQL æ€§èƒ½å¯¹æ¯”](https://www.mongodb.com/compare/mongodb-mysql)
- [Redis å®˜æ–¹æ–‡æ¡£](https://redis.io/documentation)
- [PostgreSQL vs MySQL](https://www.postgresql.org/about/)
- [æ•°æ®åº“é€‰å‹æŒ‡å—](https://db-engines.com/en/ranking)

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-11-25  
**ä½œè€…**: Chat Application Team
